setwd('/Users/emeryyi/Dropbox/Research/googleproject/spenvlp')
source("spenv.r", chdir = TRUE)#
source("spenvlp.R", chdir = TRUE)#
source("initial_value.r", chdir = TRUE)#
source("loglik.r", chdir = TRUE)#
n <- 2000#
p <- 10#
r <- 10#
u <- 9#
X <- matrix(rnorm(n * p), n, p)#
Y <- matrix(rnorm(n * r), n, r)#
res <- spenv(X, Y, u, eps=1e-10, maxit=1e4, ulam=1e-3, weight=rep(1,r-u))#
loglik(res$Gammahat, res$sigRes, res$invsigY, res$r, res$n)
res
